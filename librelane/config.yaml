# LibreLane Configuration
# Generated by sram-forge
# Chip: gf180mcu_ic_1x1_sram_u8b24k
# GF180MCU 1x1 SRAM Test Chip - 24KB unified 8-bit bus
meta:
  version: 3
  flow: Chip

DESIGN_NAME: gf180mcu_ic_1x1_sram_u8b24k_top

# Die and core areas are specified in the slot file (e.g., slot_1x1.yaml)
# Do not specify DIE_AREA/CORE_AREA here to avoid floating-point precision issues

VERILOG_FILES:
  - dir::../src/slot_defines.svh
  - dir::../src/gf180mcu_ic_1x1_sram_u8b24k_top.sv
  - dir::../src/gf180mcu_ic_1x1_sram_u8b24k_core.sv
  - dir::../src/gf180mcu_ic_1x1_sram_u8b24k_sram_array.sv

# Verilog defines
VERILOG_DEFINES:
  - USE_POWER_PINS
  - SLOT_1X1

# Use klayout for smaller GDS files
PRIMARY_GDSII_STREAMOUT_TOOL: klayout

# SDC files
PNR_SDC_FILE: dir::gf180mcu_ic_1x1_sram_u8b24k_top.sdc
SIGNOFF_SDC_FILE: dir::gf180mcu_ic_1x1_sram_u8b24k_top.sdc
FALLBACK_SDC: dir::gf180mcu_ic_1x1_sram_u8b24k_top.sdc

# Power / ground nets
VDD_NETS:
  - VDD
GND_NETS:
  - VSS

# Ignore disconnected modules (IO pads with unused outputs, wafer.space IP)
IGNORE_DISCONNECTED_MODULES:
  - gf180mcu_fd_io__bi_24t
  - gf180mcu_ws_ip__id
  - gf180mcu_ws_ip__logo

# Clock configuration
CLOCK_PORT: clk_PAD
CLOCK_NET: clk_pad/Y
CLOCK_PERIOD: 40.0  # 25.0 MHz

# Fix hold violations
PL_RESIZER_HOLD_SLACK_MARGIN: 0.35
GRT_RESIZER_HOLD_SLACK_MARGIN: 0.3

# Placement density - adjusted based on macro occupancy (77.8%)
# Lower density prevents GPL-0305 divergence with high macro utilization
PL_TARGET_DENSITY_PCT: 5
GRT_ALLOW_CONGESTION: true

# Fix antenna violations after DRT
DRT_ANTENNA_REPAIR_ITERS: 10
DRT_ANTENNA_MARGIN: 10

# PDN - Straps
PDN_VWIDTH: 5
PDN_HWIDTH: 5
PDN_VSPACING: 1
PDN_HSPACING: 1
PDN_VPITCH: 75
PDN_HPITCH: 75

# PDN - Core ring
PDN_CORE_RING: true
PDN_CORE_RING_VWIDTH: 25
PDN_CORE_RING_HWIDTH: 25
PDN_CORE_RING_CONNECT_TO_PADS: true
PDN_ENABLE_PINS: false
PDN_CORE_VERTICAL_LAYER: Metal2
PDN_CORE_HORIZONTAL_LAYER: Metal3

# Prevent false positive DRC errors in I/O cells and SRAMs
MAGIC_GDS_FLATGLOB:
  - "*_CDNS_*"
  - "COMP_fill_cell"
  - "Poly2_fill_cell"
  - "*$$*"
  - "M1_N*"
  - "M1_P*"
  - "M2_M1*"
  - "M3_M2*"
  - "nmos_5p0*"
  - "nmos_1p2*"
  - "pmos_5p0*"
  - "pmos_1p2*"
  - "via1_*"
  - "ypass_gate*"
  - "G_ring_*"
  - "dcap_103*"
  - "din_*"
  - "mux821_*"
  - "rdummy_*"
  - "pmoscap_*"
  - "xdec_*"
  - "ypredec*"
  - "xpredec*"
  - "prexdec_*"
  - "xdec8_*"
  - "xdec16_*"
  - "xdec32_*"
  - "sa_*"

# Multiple power pads for one power domain
MAGIC_EXT_UNIQUE: notopports

# Macro definitions
MACROS:
  gf180mcu_ws_ip__id:
    gds:
      - dir::../ip/gf180mcu_ws_ip__id/gds/gf180mcu_ws_ip__id.gds
    lef:
      - dir::../ip/gf180mcu_ws_ip__id/lef/gf180mcu_ws_ip__id.lef
    vh:
      - dir::../ip/gf180mcu_ws_ip__id/vh/gf180mcu_ws_ip__id.v
    lib:
      "*":
        - dir::../ip/gf180mcu_ws_ip__id/lib/gf180mcu_ws_ip__id.lib
    instances:
      chip_id:
        location: [26, 26]
        orientation: N
  gf180mcu_ws_ip__logo:
    gds:
      - dir::../ip/gf180mcu_ws_ip__logo/gds/gf180mcu_ws_ip__logo.gds
    lef:
      - dir::../ip/gf180mcu_ws_ip__logo/lef/gf180mcu_ws_ip__logo.lef
    vh:
      - dir::../ip/gf180mcu_ws_ip__logo/vh/gf180mcu_ws_ip__logo.v
    lib:
      "*":
        - dir::../ip/gf180mcu_ws_ip__logo/lib/gf180mcu_ws_ip__logo.lib
    instances:
      wafer_space_logo:
        location: ["expr::$DIE_AREA[2] + -169.25", "expr::$DIE_AREA[3] + -169.25"]
        orientation: N
  gf180mcu_fd_ip_sram__sram512x8m8wm1:
    gds:
      - pdk_dir::libs.ref/gf180mcu_fd_ip_sram/gds/gf180mcu_fd_ip_sram__sram512x8m8wm1.gds
    lef:
      - pdk_dir::libs.ref/gf180mcu_fd_ip_sram/lef/gf180mcu_fd_ip_sram__sram512x8m8wm1.lef
    vh:
      - pdk_dir::libs.ref/gf180mcu_fd_ip_sram/verilog/gf180mcu_fd_ip_sram__sram512x8m8wm1__blackbox.v
    lib:
      "*_tt_025C_5v00":
        - pdk_dir::libs.ref/gf180mcu_fd_ip_sram/lib/gf180mcu_fd_ip_sram__sram512x8m8wm1__tt_025C_5v00.lib
      "*_ff_n40C_5v50":
        - pdk_dir::libs.ref/gf180mcu_fd_ip_sram/lib/gf180mcu_fd_ip_sram__sram512x8m8wm1__ff_n40C_5v50.lib
      "*_ss_125C_4v50":
        - pdk_dir::libs.ref/gf180mcu_fd_ip_sram/lib/gf180mcu_fd_ip_sram__sram512x8m8wm1__ss_125C_4v50.lib
    instances:
      # 48 SRAMs in 6x8 arrangement
      i_chip_core.u_sram_array.sram_0:
        location: [620.42, 551.48]
        orientation: N
      i_chip_core.u_sram_array.sram_1:
        location: [1072.28, 551.48]
        orientation: N
      i_chip_core.u_sram_array.sram_2:
        location: [1524.14, 551.48]
        orientation: N
      i_chip_core.u_sram_array.sram_3:
        location: [1976.0, 551.48]
        orientation: N
      i_chip_core.u_sram_array.sram_4:
        location: [2427.86, 551.48]
        orientation: N
      i_chip_core.u_sram_array.sram_5:
        location: [2879.72, 551.48]
        orientation: N
      i_chip_core.u_sram_array.sram_6:
        location: [620.42, 1056.36]
        orientation: N
      i_chip_core.u_sram_array.sram_7:
        location: [1072.28, 1056.36]
        orientation: N
      i_chip_core.u_sram_array.sram_8:
        location: [1524.14, 1056.36]
        orientation: N
      i_chip_core.u_sram_array.sram_9:
        location: [1976.0, 1056.36]
        orientation: N
      i_chip_core.u_sram_array.sram_10:
        location: [2427.86, 1056.36]
        orientation: N
      i_chip_core.u_sram_array.sram_11:
        location: [2879.72, 1056.36]
        orientation: N
      i_chip_core.u_sram_array.sram_12:
        location: [620.42, 1561.24]
        orientation: N
      i_chip_core.u_sram_array.sram_13:
        location: [1072.28, 1561.24]
        orientation: N
      i_chip_core.u_sram_array.sram_14:
        location: [1524.14, 1561.24]
        orientation: N
      i_chip_core.u_sram_array.sram_15:
        location: [1976.0, 1561.24]
        orientation: N
      i_chip_core.u_sram_array.sram_16:
        location: [2427.86, 1561.24]
        orientation: N
      i_chip_core.u_sram_array.sram_17:
        location: [2879.72, 1561.24]
        orientation: N
      i_chip_core.u_sram_array.sram_18:
        location: [620.42, 2066.12]
        orientation: N
      i_chip_core.u_sram_array.sram_19:
        location: [1072.28, 2066.12]
        orientation: N
      i_chip_core.u_sram_array.sram_20:
        location: [1524.14, 2066.12]
        orientation: N
      i_chip_core.u_sram_array.sram_21:
        location: [1976.0, 2066.12]
        orientation: N
      i_chip_core.u_sram_array.sram_22:
        location: [2427.86, 2066.12]
        orientation: N
      i_chip_core.u_sram_array.sram_23:
        location: [2879.72, 2066.12]
        orientation: N
      i_chip_core.u_sram_array.sram_24:
        location: [620.42, 2571.0]
        orientation: N
      i_chip_core.u_sram_array.sram_25:
        location: [1072.28, 2571.0]
        orientation: N
      i_chip_core.u_sram_array.sram_26:
        location: [1524.14, 2571.0]
        orientation: N
      i_chip_core.u_sram_array.sram_27:
        location: [1976.0, 2571.0]
        orientation: N
      i_chip_core.u_sram_array.sram_28:
        location: [2427.86, 2571.0]
        orientation: N
      i_chip_core.u_sram_array.sram_29:
        location: [2879.72, 2571.0]
        orientation: N
      i_chip_core.u_sram_array.sram_30:
        location: [620.42, 3075.88]
        orientation: N
      i_chip_core.u_sram_array.sram_31:
        location: [1072.28, 3075.88]
        orientation: N
      i_chip_core.u_sram_array.sram_32:
        location: [1524.14, 3075.88]
        orientation: N
      i_chip_core.u_sram_array.sram_33:
        location: [1976.0, 3075.88]
        orientation: N
      i_chip_core.u_sram_array.sram_34:
        location: [2427.86, 3075.88]
        orientation: N
      i_chip_core.u_sram_array.sram_35:
        location: [2879.72, 3075.88]
        orientation: N
      i_chip_core.u_sram_array.sram_36:
        location: [620.42, 3580.76]
        orientation: N
      i_chip_core.u_sram_array.sram_37:
        location: [1072.28, 3580.76]
        orientation: N
      i_chip_core.u_sram_array.sram_38:
        location: [1524.14, 3580.76]
        orientation: N
      i_chip_core.u_sram_array.sram_39:
        location: [1976.0, 3580.76]
        orientation: N
      i_chip_core.u_sram_array.sram_40:
        location: [2427.86, 3580.76]
        orientation: N
      i_chip_core.u_sram_array.sram_41:
        location: [2879.72, 3580.76]
        orientation: N
      i_chip_core.u_sram_array.sram_42:
        location: [620.42, 4085.64]
        orientation: N
      i_chip_core.u_sram_array.sram_43:
        location: [1072.28, 4085.64]
        orientation: N
      i_chip_core.u_sram_array.sram_44:
        location: [1524.14, 4085.64]
        orientation: N
      i_chip_core.u_sram_array.sram_45:
        location: [1976.0, 4085.64]
        orientation: N
      i_chip_core.u_sram_array.sram_46:
        location: [2427.86, 4085.64]
        orientation: N
      i_chip_core.u_sram_array.sram_47:
        location: [2879.72, 4085.64]
        orientation: N

# Power connections for SRAM macros
PDN_MACRO_CONNECTIONS:
  - "i_chip_core.u_sram_array.sram_0 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_1 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_2 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_3 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_4 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_5 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_6 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_7 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_8 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_9 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_10 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_11 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_12 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_13 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_14 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_15 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_16 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_17 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_18 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_19 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_20 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_21 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_22 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_23 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_24 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_25 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_26 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_27 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_28 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_29 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_30 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_31 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_32 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_33 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_34 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_35 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_36 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_37 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_38 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_39 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_40 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_41 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_42 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_43 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_44 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_45 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_46 VDD VSS VDD VSS"
  - "i_chip_core.u_sram_array.sram_47 VDD VSS VDD VSS"

# Halo size around macros
FP_MACRO_HORIZONTAL_HALO: 10
FP_MACRO_VERTICAL_HALO: 10
PDN_HORIZONTAL_HALO: 5
PDN_VERTICAL_HALO: 5

PDN_CFG: dir::pdn_cfg.tcl

# LVS - flatten wafer.space IP cells
LVS_FLATTEN_CELLS:
  - gf180mcu_ws_ip__id
  - gf180mcu_ws_ip__logo

# wafer.space IP has no ports and components - make abstract cells
MAGIC_EXT_ABSTRACT_CELLS:
  - gf180mcu_ws_ip__id
  - gf180mcu_ws_ip__logo